# Prometheus configuration for local development
# Scrapes metrics from OTEL Collector and the webapp /metrics endpoint

global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  # Scrape OpenTelemetry Collector's Prometheus exporter
  # This includes all OTel metrics (batch queue, fair queue, etc.)
  - job_name: "otel-collector"
    static_configs:
      - targets: ["otel-collector:8889"]
    metrics_path: /metrics

  # Scrape webapp's /metrics endpoint
  # This includes Prisma metrics and prom-client default metrics
  # Note: The webapp runs on host machine, not in Docker network
  # Use host.docker.internal on Mac/Windows, or the actual host IP on Linux
  - job_name: "webapp"
    static_configs:
      - targets: ["host.docker.internal:3030"]
    metrics_path: /metrics
    # Uncomment if you set TRIGGER_METRICS_AUTH_PASSWORD
    # authorization:
    #   type: Bearer
    #   credentials: your-password-here

  # Prometheus self-monitoring
  - job_name: "prometheus"
    static_configs:
      - targets: ["localhost:9090"]

