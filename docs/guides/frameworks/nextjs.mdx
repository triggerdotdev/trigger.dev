---
title: "Next.js setup guide"
sidebarTitle: "Next.js"
description: "This guide will show you how to setup Trigger.dev in your existing Next.js project, test an example task, and view the run."
icon: "N"
---

import Prerequisites from '/snippets/framework-prerequisites.mdx';
import CliInitStep from '/snippets/step-cli-init.mdx';
import CliDevStep from '/snippets/step-cli-dev.mdx';
import CliRunTestStep from '/snippets/step-run-test.mdx';
import CliViewRunStep from '/snippets/step-view-run.mdx';
import UsefulNextSteps from '/snippets/useful-next-steps.mdx';

<Note>This guide can be followed for both App and Pages router as well as Server Actions.</Note>

<Prerequisites framework="Next.js" />

## Initial setup

<Steps>
    <CliInitStep />
    <CliDevStep />
    <CliRunTestStep />
    <CliViewRunStep />
</Steps>

## Triggering your task in Next.js

Here are the steps to trigger your task in the Next.js App and Pages router and Server Actions:

<Tabs>

  <Tab title="Pages Router">

    To trigger your task, you can create an API route in the `pages/api` directory. Here's an example of how you can trigger your task in the Pages router:

    ```ts
    // Next.js API route support: https://nextjs.org/docs/api-routes/introduction
    import { helloWorldTask } from "@/trigger/example";
    import type { NextApiRequest, NextApiResponse } from "next";

    export default async function handler(
    req: NextApiRequest,
    res: NextApiResponse<{ id: string }>
    ) {
    const handle = await helloWorldTask.trigger("");

    res.status(200).json(handle);
    }
    ```
  </Tab>

  <Tab title="App Router">

    App router content

  </Tab>

  <Tab title="Server Actions">
    
    Server actions content

  </Tab>

</Tabs>

## Deploying your task in Next.js

To deploy your task in Next.js, you can use Vercel, Netlify, or any other hosting provider that supports Node.js. Here's how you can deploy your task using Vercel:

If you want to deploy your task using GitHub Actions, you can follow [this guide](/github-actions).

## Troubleshooting

    ### Next.js build failing due to missing API key in GitHub CI

    This issue occurs during the Next.js app build process on GitHub CI where the Trigger.dev SDK is expecting the TRIGGER_SECRET_KEY environment variable to be set at build time. Next.js attempts to compile routes and creates static pages, which can cause issues with SDKs that require runtime environment variables. The solution is to mark the relevant pages as dynamic to prevent Next.js from trying to make them static. You can do this by adding the following line to the route file:

    ```ts
    export const dynamic = "force-dynamic";
    ```

# Todos

- Pages directory triggering
- Edge runtime triggering `tasks.trigger<>("my-task, {});`
- App directory triggering
- How to update your UI using the run status. Use `runs.retrieve` with the handle

<UsefulNextSteps />
