---
title: "Next.js setup guide"
sidebarTitle: "Next.js"
description: "This guide will show you how to setup Trigger.dev in your existing Next.js project, test an example task, and view the run."
icon: "N"
---

import Prerequisites from '/snippets/framework-prerequisites.mdx';
import CliInitStep from '/snippets/step-cli-init.mdx';
import CliDevStep from '/snippets/step-cli-dev.mdx';
import CliRunTestStep from '/snippets/step-run-test.mdx';
import CliViewRunStep from '/snippets/step-view-run.mdx';
import UsefulNextSteps from '/snippets/useful-next-steps.mdx';
import NextjsTroubleshooting from '/snippets/nextjs-missing-api-key.mdx';

<Note>This guide can be followed for both App and Pages router as well as Server Actions.</Note>

<Prerequisites framework="Next.js" />

## Initial setup

<Steps>
  <CliInitStep />
  <CliDevStep />
  <CliRunTestStep />
  <CliViewRunStep />
</Steps>

## Set your secret key

## Triggering your task in Next.js

Here are the steps to trigger your task in the Next.js App and Pages router and Server Actions:

<Tabs>

  <Tab title="Pages Router">

    To trigger your task, you can create an API route in the `pages/api` directory. Here's an example of how you can trigger your task in the Pages router:

    ```ts pages/api/hello.ts
    // Next.js API route support: https://nextjs.org/docs/api-routes/introduction
    import { helloWorldTask } from "@/trigger/example";
    import { tasks } from "@trigger.dev/sdk/v3";
    import type { NextApiRequest, NextApiResponse } from "next";

    export default async function handler(
      req: NextApiRequest,
      res: NextApiResponse<{ id: string }>
    ) {
      const handle = await tasks.trigger<typeof helloWorldTask>(
      "hello-world",
      "James"
      );

      res.status(200).json(handle);   
    }
    ```
  </Tab>

  <Tab title="App Router">

    App router content

    API route (same as Pages router)

    Server actions example

  </Tab>

</Tabs>

## Add your environment variables (optional)

Any environment variables used in your tasks need to be added to ensure the deployed code runs successfully. In Node.js, these environment variables are accessed in your code using `process.env.MY_ENV_VAR`.

In the sidebar select the "Environment Variables" page, then press the "New environment variable"
button. ![Environment variables page](/images/environment-variables-page.jpg)

You can add values for your local dev environment, staging and prod. ![Environment variables
page](/images/environment-variables-panel.jpg)

## Deploying your task in Next.js

Run the CLI deploy command

<CodeGroup>

```bash npm
npx trigger.dev@beta deploy
```

```bash pnpm
pnpm dlx trigger.dev@beta deploy
```

```bash yarn
yarn dlx trigger.dev@beta deploy
```

</CodeGroup>

We're working on adding a [Vercel integration](/vercel-integration) to Trigger.dev. In the meantime, you can follow [this guide](/github-actions) to use GitHub Actions to deploy your tasks.

## Troubleshooting

    <NextjsTroubleshooting/>

<UsefulNextSteps />
